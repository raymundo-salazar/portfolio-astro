---
import { EXPERIENCES } from "./constants"

import TimelineItem from "@/components/molecules/TimelineItem/index.astro"
import ShowMoreToggle from "@/components/molecules/ShowMoreToggle/index.astro"
import { useTranslation } from "@/i18n"

const currentLocale = Astro.params.lang || "es"
const t = useTranslation(currentLocale as "es" | "en")

const companiesCount = EXPERIENCES.map(exp => exp.company).filter(
	(value, index, self) => self.indexOf(value) === index
).length
const leadershipRolesCount = EXPERIENCES.filter(
	exp => exp.type.toLowerCase() === "leadership"
).length
const yearsOfExperience = new Date().getFullYear() - 2013
---

<section
	id="timeline"
	class="py-20 bg-neutral-800 relative transition-all duration-300 overflow-hidden"
>
	<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
		<div class="text-center mb-16">
			<h2 class="text-3xl sm:text-4xl font-bold text-white mb-4">
				{t.timeline.title}
			</h2>
			<div class="w-24 h-1 bg-blue-600 mx-auto rounded-full mb-6"></div>
			<p class="text-lg text-gray-300 max-w-2xl mx-auto">
				{t.timeline.description.replaceAll("{{YEARS}}", yearsOfExperience.toString())}
			</p>
		</div>
		<div class="relative">
			<div
				class="absolute left-4 -top-5 md:top-0 md:left-1/2 transform md:-translate-x-px h-full w-0.5 bg-neutral-600"
			>
			</div>

			<div class="space-y-12">
				{EXPERIENCES.map((exp, index) => <TimelineItem exp={exp} index={index} />)}
			</div>
		</div>
	</div>

	<ShowMoreToggle id="toggle-timeline" />
</section>
<section
	id="timeline-summary"
	class="py-20 bg-neutral-900 relative transition-all duration-300 overflow-hidden"
>
	<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
		<div class="grid grid-cols-2 md:grid-cols-4 gap-6">
			<div class="text-center p-6 bg-neutral-700 rounded-xl shadow-md">
				<div class="text-3xl font-bold text-blue-400 mb-2">
					{yearsOfExperience}+
				</div>
				<div class="text-sm text-gray-300">{t.timeline.experienceYears}</div>
			</div>
			<div class="text-center p-6 bg-neutral-700 rounded-xl shadow-md">
				<div class="text-3xl font-bold text-green-400 mb-2">{companiesCount}</div>
				<div class="text-sm text-gray-300">{t.timeline.companies}</div>
			</div>
			<div class="text-center p-6 bg-neutral-700 rounded-xl shadow-md">
				<div class="text-3xl font-bold text-purple-400 mb-2">10+</div>
				<div class="text-sm text-gray-300">{t.timeline.productionApps}</div>
			</div>
			<div class="text-center p-6 bg-neutral-700 rounded-xl shadow-md">
				<div class="text-3xl font-bold text-orange-400 mb-2">{leadershipRolesCount}</div>
				<div class="text-sm text-gray-300">{t.timeline.leadershipRoles}</div>
			</div>
		</div>
	</div>
</section>

<script src="./script.ts"></script>
